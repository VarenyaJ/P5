# .github/workflows/ci.yaml
name: CI

on:
 push:
   branches: [ main ]
 pull_request:
   branches: [ main ]

jobs:
 test:
   name: Test on ${{ matrix.os }}
   runs-on: ${{ matrix.os }}
   strategy:
     matrix:
       os: [ ubuntu-latest, macos-latest, windows-latest ]
   steps:
     - name: Checkout code
       uses: actions/checkout@v3

     - name: Setup environment
       uses: ./.github/actions/setup_env
       with:
         environment-file: requirements/environment.yml

     - name: Run tests
       run: pytest --maxfail=1 --disable-warnings -q